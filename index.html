<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRPG三折页排版器</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="toolbar">
        <div class="logo" id="logo">
            <span class="logo-text">不咕鸟</span>
            <span class="logo-sub">TRPG三折页排版器</span>
        </div>
        <div class="toolbar-buttons">
            <button id="saveBtn" title="保存到本地">💾 保存</button>
            <button id="loadBtn" title="加载本地文件">📂 加载</button>
            <button id="exportHtmlBtn" title="导出HTML">📄 导出HTML</button>
            <button id="exportPdfBtn" title="导出PDF">📑 导出PDF</button>
            <button id="printGuideBtn" title="打印排版说明">📖 打印说明</button>
            <button id="resetBtn" title="重置">🔄 重置</button>
        </div>
    </header>

    <div class="main-container">
        <aside class="sidebar">
            <div class="sidebar-section">
                <h3>📋 页面设置</h3>
                <div class="setting-group">
                    <label>内缝宽度</label>
                    <input type="number" id="gutterWidth" value="5" min="0" max="50">
                    <span class="unit">mm</span>
                </div>
                <div class="setting-group">
                    <label>页边距</label>
                    <input type="number" id="margin" value="10" min="0" max="100">
                    <span class="unit">mm</span>
                </div>
                <p class="setting-hint">提示：每个页面的大小可在页面头部单独调整</p>
                <button id="applyPageSettings" class="apply-btn">应用设置</button>
            </div>

            <div class="sidebar-section">
                <h3>🎨 内容块</h3>
                <div class="block-templates">
                    <div class="template-block" draggable="true" data-type="text">
                        <div class="template-icon">📝</div>
                        <div class="template-name">文本块</div>
                    </div>
                    <div class="template-block" draggable="true" data-type="title">
                        <div class="template-icon">🏷️</div>
                        <div class="template-name">标题块</div>
                    </div>
                    <div class="template-block" draggable="true" data-type="image">
                        <div class="template-icon">🖼️</div>
                        <div class="template-name">图片块</div>
                    </div>
                    <div class="template-block" draggable="true" data-type="table">
                        <div class="template-icon">📊</div>
                        <div class="template-name">表格块</div>
                    </div>
                    <div class="template-block" draggable="true" data-type="quote">
                        <div class="template-icon">💬</div>
                        <div class="template-name">引用块</div>
                    </div>
                    <div class="template-block" draggable="true" data-type="list">
                        <div class="template-icon">📋</div>
                        <div class="template-name">列表块</div>
                    </div>
                    <div class="template-block" draggable="true" data-type="checkbox">
                        <div class="template-icon">☑️</div>
                        <div class="template-name">复选框</div>
                    </div>
                </div>
            </div>

            <div class="sidebar-section" id="blockEditor" style="display: none;">
                <h3>✏️ 编辑块</h3>
                <div id="editorContent"></div>
                <button id="deleteBlockBtn" class="delete-btn">删除块</button>
            </div>
        </aside>

        <main class="workspace">
            <div class="trifold-container">
                <div class="trifold-side" id="frontSide">
                    <h3>正面</h3>
                    <div class="pages-container" id="frontPages"></div>
                </div>
                <div class="trifold-side" id="backSide">
                    <h3>背面</h3>
                    <div class="pages-container" id="backPages"></div>
                </div>
            </div>
        </main>
    </div>

    <div class="modal" id="authorModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="author-info">
                <h2>🎉 关于作者</h2>
                <div class="author-card">
                    <p><strong>作者：</strong>不咕鸟（基德）+ AI辅助</p>
                    <p><strong>微信：</strong>jeffyuyi</p>
                    <p><strong>QQ群：</strong>261751459</p>
                    <p class="club-name">不咕鸟TRPG创想俱乐部</p>
                </div>
                <div class="qr-placeholder">
                    <p>扫码加入我们！</p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="printGuideModal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="print-guide">
                <h2>📖 三折页打印排版说明</h2>
                <div class="guide-content">
                    <div class="guide-section">
                        <h3>📄 页面布局</h3>
                        <div class="page-layout">
                            <div class="layout-front">
                                <h4>正面布局</h4>
                                <div class="layout-diagram">
                                    <div class="layout-page">3</div>
                                    <div class="layout-page">2</div>
                                    <div class="layout-page">1</div>
                                </div>
                                <p>打印顺序：从右到左 → 3 → 2 → 1</p>
                            </div>
                            <div class="layout-back">
                                <h4>背面布局</h4>
                                <div class="layout-diagram">
                                    <div class="layout-page">4</div>
                                    <div class="layout-page">5</div>
                                    <div class="layout-page">6</div>
                                </div>
                                <p>打印顺序：从左到右 → 4 → 5 → 6</p>
                            </div>
                        </div>
                    </div>
                    <div class="guide-section">
                        <h3>📏 折叠说明</h3>
                        <ol>
                            <li>打印完成后，将纸张正面朝上</li>
                            <li>将第3页向左折叠，覆盖在第2页上</li>
                            <li>将第1页向右折叠，覆盖在第2页上</li>
                            <li>完成三折页折叠，第2页为封面</li>
                        </ol>
                    </div>
                    <div class="guide-section">
                        <h3>💡 打印提示</h3>
                        <ul>
                            <li>建议使用A4或更大尺寸的纸张</li>
                            <li>打印时选择"无边距"或"最小边距"</li>
                            <li>如果打印机不支持双面打印，可先打印正面，然后将纸张翻面再打印背面</li>
                            <li>打印前建议先预览，确保页面布局正确</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
